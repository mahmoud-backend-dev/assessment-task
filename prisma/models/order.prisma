model Order {
  id          String       @id @default(uuid()) @db.Uuid
  isActive    Boolean      @default(true)
  createdAt   DateTime     @default(now()) @map("created_at")
  updatedAt   DateTime     @updatedAt       @map("updated_at")
  deletedAt   DateTime?

  customerId  String       @db.Uuid @map("customer_id")
  status      OrderStatus  @default(PENDING)
  subtotal    Decimal      @db.Decimal(12, 2)
  deliveryFee Decimal      @db.Decimal(12, 2) @map("delivery_fee")
  vatAmount   Decimal      @db.Decimal(12, 2) @map("vat_amount")
  total       Decimal      @db.Decimal(12, 2)
  notes       String?      @db.VarChar(500)
  orderedAt   DateTime     @default(now()) @map("ordered_at")

  customer    User         @relation("CustomerOrders", fields: [customerId], references: [id], onDelete: Restrict)
  items       OrderItem[]

  @@index([customerId], map: "IDX_order_customer")
  @@index([status], map: "IDX_order_status")
  @@map("orders")
  @@schema("orders")
}

model OrderItem {
  id               String          @id @default(uuid()) @db.Uuid
  isActive         Boolean         @default(true)
  createdAt        DateTime        @default(now()) @map("created_at")
  updatedAt        DateTime        @updatedAt       @map("updated_at")
  deletedAt        DateTime?

  orderId          String          @db.Uuid @map("order_id")
  productId        String          @db.Uuid @map("product_id")
  productVariantId String?         @db.Uuid @map("product_variant_id")
  quantity         Int             @default(1)
  unitPrice        Decimal         @db.Decimal(12, 2) @map("unit_price")
  lineTotal        Decimal         @db.Decimal(12, 2) @map("line_total")

  order            Order           @relation(fields: [orderId], references: [id], onDelete: Cascade)
  product          Product         @relation(fields: [productId], references: [id], onDelete: Restrict)
  productVariant   ProductVariant? @relation(fields: [productVariantId], references: [id], onDelete: SetNull)

  @@index([productId], map: "IDX_order_item_product")
  @@index([productVariantId], map: "IDX_order_item_variant")
  @@map("order_items")
  @@schema("order_items")
}